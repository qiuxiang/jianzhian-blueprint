<!-- 护栏--><!-- 一个标尺--><!-- 一组标尺--><g transform="translate(20, 30)"><!-- 地线--><line style="" ng-if="true" ng-attr-x1="{{-40}}" ng-attr-y1="{{scaled.layer}}" ng-attr-x2="{{scaled.height + 150}}" ng-attr-y2="{{scaled.layer}}"></line><!-- 房顶--><line style="" ng-if="true" ng-attr-x1="{{-metadata.scale * 300}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.height / 2}}" ng-attr-y2="{{-metadata.scale * 500}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.height / 2}}" ng-attr-y1="{{-metadata.scale * 500}}" ng-attr-x2="{{scaled.height + metadata.scale * 300}}" ng-attr-y2="{{0}}"></line><line style="" ng-if="true" ng-attr-x1="{{-metadata.scale * 300}}" ng-attr-y1="{{-metadata.scale * 100}}" ng-attr-x2="{{scaled.height / 2}}" ng-attr-y2="{{-metadata.scale * 600}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.height / 2}}" ng-attr-y1="{{-metadata.scale * 600}}" ng-attr-x2="{{scaled.height + metadata.scale * 300}}" ng-attr-y2="{{-metadata.scale * 100}}"></line><line style="" ng-if="true" ng-attr-x1="{{-metadata.scale * 300}}" ng-attr-y1="{{-metadata.scale * 100}}" ng-attr-x2="{{-metadata.scale * 300}}" ng-attr-y2="{{0}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.height + metadata.scale * 300}}" ng-attr-y1="{{-metadata.scale * 100}}" ng-attr-x2="{{scaled.height + metadata.scale * 300}}" ng-attr-y2="{{0}}"></line><!-- 屋檐--><g ng-attr-transform="translate({{scaled.height}}, 0)"><line style="stroke-width: 3; stroke: gray;" ng-if="true" ng-attr-x1="{{3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.aisle_width}}" ng-attr-y2="{{metadata.scale * 200}}"></line><line style="stroke-width: 3; stroke: gray;" ng-if="true" ng-attr-x1="{{3}}" ng-attr-y1="{{metadata.scale * 200}}" ng-attr-x2="{{scaled.aisle_width}}" ng-attr-y2="{{metadata.scale * 200}}"></line></g><!-- 走廊--><g ng-if="metadata.layer &gt; 3" ng-attr-transform="translate({{scaled.height + 4}}, {{scaled.P * 3 - scaled.aisle_height}})"><line style="stroke-width: 3;" ng-repeat="i in _.range(0, 5)" x1="0" ng-attr-y1="{{scaled.aisle_height * 0.25 * i}}" ng-attr-x2="{{scaled.aisle_width - 2}}" ng-attr-y2="{{scaled.aisle_height * 0.25 * i +0}}"></line><line style="stroke-width: 3;" ng-if="true" ng-attr-x1="{{scaled.aisle_width - 4}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.aisle_width - 4}}" ng-attr-y2="{{scaled.layer - scaled.P * 3 + scaled.aisle_height}}"></line><g ng-if="metadata.layer &gt; 6" ng-attr-transform="translate(0, {{scaled.P * 3}})"><line style="stroke-width: 3;" ng-repeat="i in _.range(0, 5)" x1="0" ng-attr-y1="{{scaled.aisle_height * 0.25 * i}}" ng-attr-x2="{{scaled.aisle_width * (1 + has_front_stairs) - 4}}" ng-attr-y2="{{scaled.aisle_height * 0.25 * i +0}}"></line></g><g ng-if="has_front_stairs" ng-attr-transform="translate({{scaled.aisle_width - 2}}, 0)"><line style="stroke-width: 3;" ng-repeat="i in _.range(0, 5)" x1="0" ng-attr-y1="{{scaled.aisle_height * 0.25 * i}}" ng-attr-x2="{{scaled.aisle_width - 2}}" ng-attr-y2="{{scaled.aisle_height * 0.25 * i +0}}"></line><line style="stroke-width: 3;" ng-if="true" ng-attr-x1="{{scaled.aisle_width - 4}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.aisle_width - 4}}" ng-attr-y2="{{scaled.layer - scaled.P * 3 + scaled.aisle_height}}"></line><g ng-attr-transform="translate(-2, {{scaled.aisle_height}})"><rect style="fill: url(#StairsPattern); stroke: none;" ng-if="true" ng-click="" ng-attr-x="{{0}}" ng-attr-y="{{0}}" ng-attr-width="{{scaled.aisle_width - 2}}" ng-attr-height="{{scaled.layer - scaled.P * 3}}"></rect></g></g></g><!-- 只有两层的楼梯--><g ng-if="metadata.options.stairs.left &amp;&amp; metadata.layer == 6" ng-attr-transform="translate({{scaled.height - scaled.K * 2}}, {{scaled.layer - scaled.aisle_height}})"><line style="stroke-width: 3;" ng-repeat="i in _.range(0, 5)" x1="0" ng-attr-y1="{{scaled.aisle_height * 0.25 * i}}" ng-attr-x2="{{scaled.K * 2 + 4}}" ng-attr-y2="{{scaled.aisle_height * 0.25 * i +-scaled.K * 1.5 - 6}}"></line><!-- 栏杆竖线g(ng-attr-transform='translate(0, {{-scaled.P * 3}})')
  +ng-line(0, 'scaled.P * 3 + scaled.aisle_height',
    0, 'scaled.P * 3')(style=line_border)
  +ng-line('800 * metadata.scale', 'scaled.P * 3 * 0.75 + scaled.aisle_height',
    '800 * metadata.scale', 'scaled.P * 3 * 0.75')(style=line_border)
  +ng-line('1600 * metadata.scale', 'scaled.P * 3 * 0.5 + scaled.aisle_height + 1',
    '1600 * metadata.scale', 'scaled.P * 3 * 0.5 + 1')(style=line_border)
  +ng-line('2400 * metadata.scale', 'scaled.P * 3 * 0.25 + scaled.aisle_height + 2',
    '2400 * metadata.scale', 'scaled.P * 3 * 0.25 + 2')(style=line_border)
    --></g><!-- 超过两层的楼梯--><g ng-if="metadata.options.stairs.left &amp;&amp; metadata.layer &gt; 6" ng-attr-transform="translate({{scaled.height - scaled.K}}, {{scaled.P * 4.5 - scaled.aisle_height}})"><line style="stroke-width: 3;" ng-if="true" ng-attr-x1="{{-scaled.aisle_width}}" ng-attr-y1="{{0}}" ng-attr-x2="{{-scaled.aisle_width}}" ng-attr-y2="{{scaled.layer - scaled.P * 4.5 + scaled.aisle_height}}"></line><g ng-repeat="layer in metadata.rooms" ng-if="!$last" ng-attr-transform="translate(0, {{$index * scaled.P * 3}})"><line style="stroke-width: 3;" ng-repeat="i in _.range(0, 5)" x1="0" ng-attr-y1="{{scaled.aisle_height * 0.25 * i}}" ng-attr-x2="{{scaled.K + 4}}" ng-attr-y2="{{scaled.aisle_height * 0.25 * i +-scaled.P * 1.5}}"></line><line style="stroke-width: 3;" ng-repeat="i in _.range(0, 5)" x1="0" ng-attr-y1="{{scaled.aisle_height * 0.25 * i}}" ng-attr-x2="{{scaled.K + 4}}" ng-attr-y2="{{scaled.aisle_height * 0.25 * i +scaled.P * 1.5}}"></line><g ng-attr-transform="translate({{-scaled.aisle_width}}, 0)"><line style="stroke-width: 3;" ng-repeat="i in _.range(0, 5)" x1="0" ng-attr-y1="{{scaled.aisle_height * 0.25 * i}}" ng-attr-x2="{{scaled.aisle_width}}" ng-attr-y2="{{scaled.aisle_height * 0.25 * i +0}}"></line><line style="" ng-if="true" ng-attr-x1="{{0}}" ng-attr-y1="{{0}}" ng-attr-x2="{{0}}" ng-attr-y2="{{scaled.aisle_height}}"></line></g></g></g><!-- 主体--><g ng-repeat="layer in metadata.rooms" ng-attr-transform="translate(0, {{scaled.P * $index * 3}})"><g ng-repeat="i in _.range(metadata.height)" ng-attr-transform="translate({{scaled.K * $index}}, 0)"><line style="" ng-if="true" ng-attr-x1="{{0}}" ng-attr-y1="{{0}}" ng-attr-x2="{{0}}" ng-attr-y2="{{scaled.P * 3}}"></line><line style="" ng-if="true" ng-attr-x1="{{3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{3}}" ng-attr-y2="{{scaled.P * 3}}"></line><line style="" ng-if="true" ng-attr-x1="{{4}}" ng-attr-y1="{{scaled.P * 0.5}}" ng-attr-x2="{{scaled.K}}" ng-attr-y2="{{scaled.P * 2.5}}"></line><line style="" ng-if="true" ng-attr-x1="{{4}}" ng-attr-y1="{{scaled.P * 2.5}}" ng-attr-x2="{{scaled.K}}" ng-attr-y2="{{scaled.P * 0.5}}"></line><line style="" ng-if="$last" ng-attr-x1="{{scaled.K}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K}}" ng-attr-y2="{{scaled.P * 3}}"></line><line style="" ng-if="$last" ng-attr-x1="{{scaled.K + 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K + 3}}" ng-attr-y2="{{scaled.P * 3}}"></line></g><!-- 深度为3K时的房顶柱--><g ng-if="metadata.height == 3 &amp;&amp; $first"><line style="" ng-if="true" ng-attr-x1="{{0}}" ng-attr-y1="{{0}}" ng-attr-x2="{{0}}" ng-attr-y2="{{-metadata.scale * 30}}"></line><line style="" ng-if="true" ng-attr-x1="{{3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{3}}" ng-attr-y2="{{-metadata.scale * 50}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K}}" ng-attr-y2="{{-metadata.scale * 330}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K + 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K + 3}}" ng-attr-y2="{{-metadata.scale * 350}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 2}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 2}}" ng-attr-y2="{{-metadata.scale * 330}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 2 + 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 2 + 3}}" ng-attr-y2="{{-metadata.scale * 350}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 3 + 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 3 + 3}}" ng-attr-y2="{{-metadata.scale * 30}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 3}}" ng-attr-y2="{{-metadata.scale * 50}}"></line></g><!-- 深度为4K时的房顶柱--><g ng-if="metadata.height == 4 &amp;&amp; $first"><line style="" ng-if="true" ng-attr-x1="{{0}}" ng-attr-y1="{{0}}" ng-attr-x2="{{0}}" ng-attr-y2="{{-metadata.scale * 30}}"></line><line style="" ng-if="true" ng-attr-x1="{{3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{3}}" ng-attr-y2="{{-metadata.scale * 40}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K}}" ng-attr-y2="{{-metadata.scale * 260}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K + 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K + 3}}" ng-attr-y2="{{-metadata.scale * 270}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 2}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 2}}" ng-attr-y2="{{-metadata.scale * 500}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 2 + 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 2 + 3}}" ng-attr-y2="{{-metadata.scale * 500}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 3 + 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 3 + 3}}" ng-attr-y2="{{-metadata.scale * 260}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 3}}" ng-attr-y2="{{-metadata.scale * 270}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 4 + 3}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 4 + 3}}" ng-attr-y2="{{-metadata.scale * 30}}"></line><line style="" ng-if="true" ng-attr-x1="{{scaled.K * 4}}" ng-attr-y1="{{0}}" ng-attr-x2="{{scaled.K * 4}}" ng-attr-y2="{{-metadata.scale * 40}}"></line></g></g><!-- 标尺--><g ng-attr-transform="translate(0, {{scaled.layer + 20}})"><g ng-attr-transform="translate({{-metadata.scale * 80}}, 0)"><g ng-attr-transform=""><line style="" ng-if="true" ng-attr-x1="{{0}}" ng-attr-y1="{{0}}" ng-attr-x2="{{0}}" ng-attr-y2="{{40}}"></line><line style="" ng-if="true" ng-attr-x1="{{(scaled.K*metadata.height+metadata.scale*160)}}" ng-attr-y1="{{0}}" ng-attr-x2="{{(scaled.K*metadata.height+metadata.scale*160)}}" ng-attr-y2="{{40}}"></line><line style="" ng-if="true" ng-attr-x1="{{0}}" ng-attr-y1="{{40-6}}" ng-attr-x2="{{(scaled.K*metadata.height+metadata.scale*160)}}" ng-attr-y2="{{40-6}}"></line><text style="text-anchor: middle;" ng-attr-x="{{(scaled.K*metadata.height+metadata.scale*160)/2}}" ng-attr-y="{{40-10}}">{{defines.K*metadata.height+160}}</text></g></g><text x="-6" y="0">80</text><text ng-attr-x="{{scaled.K*metadata.height-3}}" y="0">80</text><g ng-repeat="i in _.range(metadata.height)" ng-attr-transform="translate({{scaled.K * $index}}, 0)"><g ng-attr-transform=""><line style="" ng-if="true" ng-attr-x1="{{0}}" ng-attr-y1="{{0}}" ng-attr-x2="{{0}}" ng-attr-y2="{{20}}"></line><line style="" ng-if="true" ng-attr-x1="{{(scaled.K)}}" ng-attr-y1="{{0}}" ng-attr-x2="{{(scaled.K)}}" ng-attr-y2="{{20}}"></line><line style="" ng-if="true" ng-attr-x1="{{0}}" ng-attr-y1="{{20-6}}" ng-attr-x2="{{(scaled.K)}}" ng-attr-y2="{{20-6}}"></line><text style="text-anchor: middle;" ng-attr-x="{{(scaled.K)/2}}" ng-attr-y="{{20-10}}">{{defines.K}}</text></g><g transform="translate(0, 60)"><line x1="0" y1="-10" x2="0" y2="-40"></line><circle cx="0" cy="0" r="8" fill="transparent" stroke="black"></circle><text x="-3" y="3">{{metadata.height-$index|letter}}</text><g ng-attr-transform="translate({{scaled.K}}, 0)" ng-if="$last"><line x1="0" y1="-10" x2="0" y2="-40"></line><circle cx="0" cy="0" r="8" fill="transparent" stroke="black"></circle><text x="-3" y="3">{{0|letter}}</text></g></g></g></g></g>