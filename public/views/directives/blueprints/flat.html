<svg ng-attr-width="{{defines.blueprint.width}}" ng-attr-height="{{defines.blueprint.height}}" class="blueprint"><g fill="white"><rect x="0" y="0" ng-attr-width="{{defines.blueprint.width}}" ng-attr-height="{{defines.blueprint.height}}"></rect><g transform="translate(10, 10)"><rect x="40" y="0" ng-attr-width="{{defines.blueprint.width - 60}}" ng-attr-height="{{defines.blueprint.height - 20}}"></rect><rect x="0" y="0" width="40" height="200"></rect><line x1="10" y1="0" x2="10" y2="200"></line><line x1="20" y1="0" x2="20" y2="200"></line><line x1="30" y1="0" x2="30" y2="200"></line><line x1="0" y1="50" x2="40" y2="50"></line><line x1="0" y1="100" x2="40" y2="100"></line><line x1="0" y1="150" x2="40" y2="150"></line><g transform="rotate(270 28 18)"><text x="0" y="-1">（日期）</text><text x="-50" y="-1">（签名）</text><text x="-100" y="-1">（实名）</text><text x="-150" y="-1">（专业）</text></g></g><g ng-attr-transform="translate({{defines.blueprint.width - 590}}, {{defines.blueprint.height - 90}})"><rect x="0" y="0" width="580" height="80"></rect><line x1="0" y1="20" x2="580" y2="20"></line><line x1="0" y1="40" x2="580" y2="40"></line><line x1="0" y1="60" x2="580" y2="60"></line><line x1="60" y1="0" x2="60" y2="80"></line><line x1="140" y1="20" x2="140" y2="80"></line><line x1="180" y1="20" x2="180" y2="80"></line><line x1="260" y1="0" x2="260" y2="20"></line><line x1="310" y1="0" x2="310" y2="20"></line><rect x="260" y="20" width="30" height="60" fill="white"></rect><rect x="290" y="20" width="160" height="60" fill="white"></rect><line x1="450" y1="0" x2="450" y2="20"></line><line x1="490" y1="0" x2="490" y2="80"></line><g><text x="0" y="14"><tspan x="4">设计单位</tspan><tspan x="264">工程名称</tspan><tspan x="454">阶段</tspan></text><text x="0" y="34"><tspan x="4">审定</tspan><tspan x="144">审核</tspan><tspan x="454">项目号</tspan></text><text x="0" y="54"><tspan x="4">项目负责人</tspan><tspan x="144">校对</tspan><tspan x="454">图号</tspan></text><text x="0" y="74"><tspan x="4">专业负责人</tspan><tspan x="144">设计</tspan><tspan x="454">日期</tspan></text><text x="276" y="36" letter-spacing="8" class="text-vertical">图名</text><text x="300" y="60" style="font-size: 20">{{$attrs.layer|t}}层平面布置图</text></g></g></g><g transform="translate(50, 10)"><marker id="ArrowMend" overflow="visible" orient="auto"><path id="ArrowPath" d="M 0.0,0.0 L 5.0,-5.0 L -12.5,0.0 L 5.0,5.0 L 0.0,0.0 Z" transform="scale(0.4) rotate(180) translate(10, 0)"></path></marker><pattern id="StairsPattern" width="0.1" height="0.1"><line x1="0" y1="0" x2="10" y2="0"></line></pattern><pattern id="RailingPattern" width="100" ng-attr-height="{{metadata.scale * 312}}" patternUnits="userSpaceOnUse"><line x1="0" y1="0" x2="100" y2="0" stroke-width="5"></line></pattern><pattern id="RoofPattern" ng-attr-width="{{metadata.scale * 310}}" height="100" patternUnits="userSpaceOnUse"><line x1="0" y1="0" x2="0" y2="100" stroke-width="5"></line></pattern><g ng-attr-transform="translate(20, {{$parent.defines.blueprint.height - 60}})"><text style="font-size: 14px;"><tspan>M:B820XH2000单开防盗门</tspan><tspan x="0" y="20">C:B1740XH955塑钢推拉窗</tspan></text></g><g ng-attr-transform="translate({{($parent.defines.blueprint.width - $parent.scaled.width - 200) / 2}}, 100)"><!-- 纵向标尺--><g transform="translate(0, 0)" letter-spacing="-3"><line x1="50" y1="0" x2="50" ng-attr-y2="{{$parent.scaled.height}}"></line><line x1="30" ng-attr-y1="{{-$parent.metadata.scale * 80}}" x2="30" ng-attr-y2="{{$parent.scaled.height + $parent.metadata.scale * 80}}"></line><line x1="22" ng-attr-y1="{{-$parent.metadata.scale * 80}}" x2="70" ng-attr-y2="{{-$parent.metadata.scale * 80}}"></line><line x1="22" ng-attr-y1="{{$parent.scaled.height + $parent.metadata.scale * 80}}" x2="70" ng-attr-y2="{{$parent.scaled.height + $parent.metadata.scale * 80}}"></line><g class="text-vertical"><text x="22" ng-attr-y="{{$parent.scaled.height / 2}}" text-anchor="middle">{{$parent.metadata.height * $parent.defines.K + 160}}</text><text x="74" y="0" text-anchor="middle">80</text><text x="74" ng-attr-y="{{$parent.scaled.height + 2}}" text-anchor="middle">80</text></g><g ng-repeat="i in _.range($parent.metadata.height)" ng-attr-transform="translate(0, {{$parent.scaled.K * $index}})"><line x1="10" y1="0" x2="70" y2="0"></line><circle cx="0" cy="0" r="8" fill="transparent" stroke="black"></circle><text x="-3" y="3">{{$index|letter}}</text><g class="text-vertical"><text x="44" ng-attr-y="{{$parent.scaled.K / 2}}" text-anchor="middle" class="text-vertical">{{$parent.defines.K}}</text></g><g ng-attr-transform="translate(0, {{$parent.scaled.K}})" ng-if="$last"><circle cx="0" cy="0" r="8" fill="transparent" stroke="black"></circle><line x1="10" y1="0" x2="70" y2="0"></line><text x="-3" y="3">{{$index + 1|letter}}</text></g></g><g ng-attr-transform="translate(50, {{$parent.scaled.height}})"><line x1="0" ng-attr-y1="{{$parent.metadata.scale * 80}}" x2="0" ng-attr-y2="{{$parent.scaled.aisle_width}}"></line><line x1="-10" ng-attr-y1="{{$parent.scaled.aisle_width}}" x2="20" ng-attr-y2="{{$parent.scaled.aisle_width}}"></line><g class="text-vertical"><text x="-6" ng-attr-y="{{$parent.scaled.aisle_width / 2}}" text-anchor="middle">{{$parent.defines.aisle_width}}</text></g></g></g><g ng-attr-transform="translate({{100 + $parent.metadata.options.stairs.left * $parent.scaled.aisle_width}}, 0)"><!-- 左楼梯--><g ng-if="$parent.metadata.options.stairs.left" ng-attr-transform="translate({{-$parent.scaled.aisle_width}}, {{$parent.scaled.height - $parent.scaled.stairs_height}})"><rect fill="url(#StairsPattern)" x="0" y="0" ng-attr-width="{{$parent.scaled.aisle_width}}" ng-attr-height="{{$parent.scaled.stairs_height}}"></rect><line x1="0" ng-attr-y1="{{$parent.scaled.stairs_height + $parent.scaled.aisle_width}}" ng-attr-x2="{{$parent.scaled.aisle_width}}" ng-attr-y2="{{$parent.scaled.stairs_height + $parent.scaled.aisle_width}}" class="border"></line><line x1="0" y1="0" x2="0" ng-attr-y2="{{$parent.scaled.stairs_height + $parent.scaled.aisle_width}}" class="border"></line><!-- 下标尺--><g ng-attr-transform="translate(0, {{$parent.scaled.stairs_height + $parent.scaled.aisle_width + 20}})"><line x1="0" y1="0" x2="0" y2="20"></line><line x1="0" y1="15" ng-attr-x2="{{$parent.scaled.aisle_width - $parent.metadata.scale * 80}}" y2="15"></line><text ng-attr-x="{{$parent.scaled.aisle_width / 2}}" y="10" text-anchor="middle">{{$parent.defines.aisle_width}}</text></g></g><!-- 右楼梯--><g ng-if="$parent.metadata.options.stairs.right" ng-attr-transform="translate({{$parent.scaled.width}}, {{$parent.scaled.height - $parent.scaled.stairs_height}})"><rect fill="url(#StairsPattern)" x="0" y="0" ng-attr-width="{{$parent.scaled.aisle_width}}" ng-attr-height="{{$parent.scaled.stairs_height}}"></rect><line x1="0" ng-attr-y1="{{$parent.scaled.stairs_height + $parent.scaled.aisle_width}}" ng-attr-x2="{{$parent.scaled.aisle_width}}" ng-attr-y2="{{$parent.scaled.stairs_height + $parent.scaled.aisle_width}}" class="border"></line><line ng-attr-x1="{{$parent.scaled.aisle_width}}" y1="0" ng-attr-x2="{{$parent.scaled.aisle_width}}" ng-attr-y2="{{$parent.scaled.stairs_height + $parent.scaled.aisle_width}}" class="border"></line><!-- 下标尺--><g ng-attr-transform="translate(0, {{$parent.scaled.stairs_height + $parent.scaled.aisle_width + 20}})"><line ng-attr-x1="{{$parent.scaled.aisle_width}}" y1="0" ng-attr-x2="{{$parent.scaled.aisle_width}}" y2="20"></line><line ng-attr-x1="{{$parent.metadata.scale * 80}}" y1="15" ng-attr-x2="{{$parent.scaled.aisle_width}}" y2="15"></line><text ng-attr-x="{{$parent.scaled.aisle_width / 2}}" y="10" text-anchor="middle">{{$parent.defines.aisle_width}}</text></g></g><g ng-repeat="room in rooms" ng-attr-transform="translate({{$parent.scaled.K * $index}}, 0)" font-size="16" font-weight="bold" text-anchor="middle"><rect ng-click="clicked(room)" x="0" y="0" title="hello" ng-attr-width="{{$parent.scaled.K}}" ng-attr-height="{{$parent.scaled.height}}" class="background"></rect><rect ng-if="$first" x="0" y="0" width="2.5" ng-attr-height="{{$parent.scaled.height}}" class="board"></rect><rect ng-if="room.board" ng-attr-x="{{$parent.scaled.K}}" y="0" width="2.5" ng-attr-height="{{$parent.scaled.height}}" class="board"></rect><rect ng-if="room.back == $parent.defines.board_types.board" x="0" y="0" ng-attr-width="{{$parent.scaled.K}}" height="2.5" class="board"></rect><g ng-if="room.back == $parent.defines.board_types.window"><rect x="0" y="0" ng-attr-width="{{$parent.scaled.K}}" height="2.5" class="window"></rect><text ng-attr-x="{{$parent.scaled.K / 2}}" y="16">C</text></g><g ng-if="room.front == $parent.defines.board_types.window"><rect x="0" ng-attr-y="{{$parent.scaled.height}}" ng-attr-width="{{$parent.scaled.K}}" height="2.5" class="window"></rect><text ng-attr-x="{{$parent.scaled.K / 2}}" ng-attr-y="{{$parent.scaled.height - 2}}">C</text></g><g ng-if="room.front == $parent.defines.board_types.board"><rect x="0" ng-attr-y="{{$parent.scaled.height}}" ng-attr-width="{{$parent.scaled.K}}" height="2.5" class="board"></rect></g><g ng-if="room.front == $parent.defines.board_types.gate"><rect x="0" ng-attr-y="{{$parent.scaled.height}}" ng-attr-width="{{$parent.scaled.K / 2}}" height="2.5" class="board"></rect><rect ng-attr-x="{{$parent.scaled.K - 2.5}}" ng-attr-y="{{$parent.scaled.height - $parent.scaled.K / 2}}" width="2.5" ng-attr-height="{{$parent.scaled.K / 2}}" class="window"></rect><text ng-attr-x="{{$parent.scaled.K * 0.75}}" ng-attr-y="{{$parent.scaled.height - 2}}">M</text><path ng-attr-d="M{{$parent.scaled.K / 2}},{{$parent.scaled.height}} Q{{$parent.scaled.K * 0.5}},{{$parent.scaled.height - $parent.scaled.K * 0.5}} {{$parent.scaled.K}},{{$parent.scaled.height - $parent.scaled.K * 0.5}}" stroke="silver" fill="none"></path></g></g><g ng-attr-transform="translate(0, {{$parent.scaled.height}})"><!-- 走廊--><g><line x1="0" ng-attr-y1="{{$parent.scaled.aisle_width}}" ng-attr-x2="{{$parent.scaled.width}}" ng-attr-y2="{{$parent.scaled.aisle_width}}" class="border"></line><line ng-if="!$parent.metadata.options.stairs.left" x1="0" ng-attr-y1="0" x2="0" ng-attr-y2="{{$parent.scaled.aisle_width}}" class="border"></line><line ng-if="!$parent.metadata.options.stairs.right" ng-attr-x1="{{$parent.scaled.width}}" ng-attr-y1="0" ng-attr-x2="{{$parent.scaled.width}}" ng-attr-y2="{{$parent.scaled.aisle_width}}" class="border"></line></g><g transform="translate(0, 60)">// 横向标尺<line x1="0" y1="15" ng-attr-x2="{{$parent.scaled.width}}" y2="15"></line><line ng-attr-x1="{{-$parent.metadata.scale * 80}}" y1="45" ng-attr-x2="{{$parent.scaled.width + $parent.metadata.scale * 80}}" y2="45"></line><line ng-attr-x1="{{-$parent.metadata.scale * 80}}" y1="0" ng-attr-x2="{{-$parent.metadata.scale * 80}}" y2="50"></line><line ng-attr-x1="{{$parent.scaled.width + $parent.metadata.scale * 80}}" y1="0" ng-attr-x2="{{$parent.scaled.width + $parent.metadata.scale * 80}}" y2="50"></line><text ng-attr-x="{{$parent.scaled.width / 2}}" y="42" text-anchor="middle" font-weight="bold">{{$parent.metadata.width * $parent.defines.K + 160}}</text><text x="-6" y="0">80</text><text ng-attr-x="{{$parent.scaled.width - 3}}" y="0">80</text><g ng-repeat="room in rooms" ng-attr-transform="translate({{$parent.scaled.K * $index}}, 0)"><line x1="0" y1="0" x2="0" y2="60"></line><line ng-if="$last" ng-attr-x1="{{$parent.scaled.K}}" y1="0" ng-attr-x2="{{$parent.scaled.K}}" y2="60"></line><text ng-attr-x="{{$parent.scaled.K / 2}}" y="10" text-anchor="middle">{{$parent.defines.K}}</text><g transform="translate(0, 70)"><circle cx="0" cy="0" r="8" fill="transparent" stroke="black"></circle><text x="-3" y="3">{{$index + 1}}</text></g><g ng-attr-transform="translate({{$parent.scaled.K}}, 70)" ng-if="$last"><circle cx="0" cy="0" r="8" fill="transparent" stroke="black"></circle><text x="-4" y="3">{{$index + 2}}</text></g></g></g></g></g></g></g></svg>